<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login</title>
</head>
<body>
    <form id="active" onsubmit="loginUser(event)">
        <label>Email</label>
        <input id="email" name="email" type="email" required/> 
        <label>password</label>
        <input id="password" name="password" type="password" required/>
        <button id="loginButton">login</button></form><br>
        
        <a id="resetlink" href="C:\Users\HP 3500TX\Desktop\firstgit\expensesignup.html">New User -signup</a>
    </form>
    <form id="form" onsubmit="gotEmail(event)">

        <button id="forgotPassword" onclick="forgotpassword(event)">forgot Password?</button>
    </form>
   
    
</body>
</html>


<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.2.0/axios.min.js"></script>
<script>
    async function loginUser(event){
        event.preventDefault()
    const email=event.target.email.value;
    const password=event.target.password.value;
    const obj={
        email,
        password
    }
    
    await axios.post("http://localhost:4000/user/login",obj)
    .then((response)=>{   
        console.log(response)
        document.getElementById('email').value=''
    document.getElementById('password').value=''
        window.alert(response.message)
        localStorage.setItem('token',response.token)
        //onclick(open("file:///C:/Users/HP%203500TX/Desktop/firstgit/addExpense.html"))
        onclick(window.location.href = "./addexpense.html");
        }
    )
    .catch(err=>{console.log(JSON.stringify(err))})
    }
    function forgotpassword(event){
    
    try{
        const form=document.getElementById('form')
    const emailId=document.createElement('input')
    emailId.type='email'
    emailId.name='emailId'
    form.innerHTML=`<p>enter your emailId<p>`
    var btnSubmit=document.createElement('Button')
    btnSubmit.innerText='submit'
   
    
    form.appendChild(emailId)
    form.appendChild(btnSubmit)
    
    }
    catch(err){
        console.log(err)}
}
async function gotEmail(event){
    try{
       
        const emailId=event.target.emailId.value

//const response=await axios.post(`http://localhost:4000/user/forgotPassword`)
const parentNode = document.getElementById("resetLink")

const forgotPassword = await axios.post(
  `http://localhost:4000/user/forgotPassword/${email}`
);

console.log(forgotPassword);
const childNode = forgotPassword.data.resetlink;
parentNode.innerHTML = childNode;

    }
    catch(err){
        console.log(err)
    }



}
</script>